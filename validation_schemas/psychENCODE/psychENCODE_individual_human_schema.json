{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id":"http://example.com/psychENCODE_schema.json",
  "title": "PsychENCODE Individual Human Metadata Schema",
  "description": "Validates PsychENCODE individual human metadata",
  "type": "object",
  "properties": {
    "individualID": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/experimentalData.json#/definitions/individualID"
    },
    "individualIdSource": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/experimentalData.json#/definitions/individualIdSource"
    },
    "species": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/experimentalData.json#/definitions/species"
    },
    "reportedGender": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/reportedGender"
    },
    "postmortem": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/postmortem"
    },
    "sexChromosome": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/experimentalData.json#/definitions/sexChromosome"
    },
    "race": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/race"
    },
    "raceDetail": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/raceDetail"
    },
    "genotypeInferredAncestry": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/genotypeInferredAncestry"
    },
    "IQ": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/IQ"
    },
    "BMI": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/BMI"
    },
    "primaryDiagnosis": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/experimentalData.json#/definitions/diagnosis"
    },
    "primaryDiagnosisDetail": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/primaryDiagnosisDetail"
    },
    "otherDiagnosis": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/otherDiagnosis"
    },
    "otherDiagnosisDetail": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/otherDiagnosisDetail"
    },
    "familyHistory": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/familyHistory"
    },
    "ageOnset": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/ageOnset"
    },
    "neuropathDescription" : {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/neuropathDescription"
    },
    "dementia": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/dementia"
    },
    "CDR": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/CDR"
    },
    "braak": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/braak"
    },
    "otherMedicalDx": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/otherMedicalDx"
    },
    "otherMedicalDetail": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/otherMedicalDetail"
    },
    "ageOfDeath": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/ageOfDeath"
    },
    "ageOfDeathUnits": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/ageOfDeathUnits"
    },
    "causeOfDeath": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/causeOfDeath"
    },
    "mannerOfDeath": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/mannerOfDeath"
    },
    "postmortemTox": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/postmortemTox"
    },
    "postmortemToxSource": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/postmortemToxSource"
    },
    "medRecordTox": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/medRecordTox"
    },
    "PMICertain": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/neuro.json#/definitions/PMICertain"
    },
    "PMI": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/neuro.json#/definitions/PMI"
    },
    "pH": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/current_annotations_schemas/neuro.json#/definitions/pH"
    },
    "yearAutopsy": {
      "$ref": "https://raw.githubusercontent.com/cw-dvr8/JSON-validation-schemas/master/validation_schemas/reference_definitions/clinicalData.json#/definitions/yearAutopsy"
    }
  },
  "required": [
    "individualID",
    "individualIdSource",
    "species",
    "reportedGender",
    "postmortem"
  ],
  "allOf": [
    {
      "if": {
        "properties": {
          "species": {
            "const": "Human"
          }
        }
      },
      "then": {
        "required": ["sexChromosome", "race", "raceDetail", "genotypeInferredAncestry", "IQ", "BMI",
                     "primaryDiagnosis", "primaryDiagnosisDetail", "otherDiagnosis", "familyHistory",
                     "ageOnset", "neuropathDescription", "dementia", "otherMedicalDx"]
      }
    },
    {
      "if": {
        "allOf": [
          {
            "properties": {
              "species": {
                "const": "Human"
              },
              "otherDiagnosis": {
                "not": {"const": "None"}
              }
            },
	    "required": ["otherDiagnosis"]
          }
        ]
      },
      "then": {
        "required": ["otherDiagnosisDetail"]
      }
    },
    {
      "if": {
        "allOf": [
          {
            "properties": {
              "species": {
                "const": "Human"
              },
	      "dementia": {
                "const": true
              }
            },
            "required": ["dementia"]
          }
        ]
      },
      "then": {
        "required": ["CDR", "braak"]
      }
    },
    {
      "if": {
        "allOf": [
          {
            "properties": {
              "species": {
                "const": "Human"
              },
              "otherMedicalDx": {
                "not": {"const": "None"}
              }
            },
            "required": ["otherMedicalDx"]
          }
        ]
      },
      "then": {
        "required": ["otherMedicalDetail"]
      }
    },
    {
      "if": {
        "allOf": [
          {
            "properties": {
              "species": {
                "const": "Human"
              },
              "postmortem": {
                "const": "true"
              }
            },
	    "required": ["postmortem"]
          }
        ]
      },
      "then": {
        "required": ["deathAge", "deathAgeUnits", "causeDeath", "deathManner", "postmortemTox",
	             "postmortemToxSource", "medRecordTox"]
      }
    },
    {
      "if": {
        "properties": {
          "postmortem": {
            "const": "true"
          }
        }
      },
      "then": {
        "required": ["PMICertain", "PMI", "yearAutopsy"]
      }
    }
  ]
}
